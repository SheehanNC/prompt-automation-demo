# Workflow Name
name: Process Prompt

# Trigger workflow when a Markdown file in prompts/ folder is added or changed
on:
  push:
    paths:
      - 'prompts/**.md'

# Define jobs
jobs:
  read-prompt:
    # Virtual machine to run the job
    runs-on: ubuntu-latest

    # Steps of the job
    steps:
      # Step 1: Checkout the repo to the virtual machine
      - name: Checkout repo
        uses: actions/checkout@v3

      # Step 2: Read and display Markdown prompt
      - name: Generate Issue Summary
        run: |
          for file in prompts/*.md; do
            echo "-------------------------------"
            echo "Processing file: $file"

            # Extract Title
            TITLE=$(grep '^# ' "$file" | sed 's/# //')
            echo "Issue Title: $TITLE"

            # Extract Context
            echo "Context:"
            awk '/## Context/{flag=1;next}/## Instructions/{flag=0}flag' "$file"

            # Extract Instructions
            echo "Instructions:"
            awk '/## Instructions/{flag=1;next}/##/{flag=0}flag' "$file"

            # Simulate Assignment
            ASSIGNEE="developer1"
            echo "Assigned to: $ASSIGNEE"

            # Simulate Priority
            PRIORITY=$(grep -i "Priority:" "$file" | sed 's/- Priority: //')
            if [ -z "$PRIORITY" ]; then
              PRIORITY="Medium"
            fi
            echo "Priority: $PRIORITY"

            echo "-------------------------------"
          done
        